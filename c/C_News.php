<?php//// Конттроллер страниц.//class C_News extends C_Base{	//	// Конструктор.	//	public function __construct(){		parent::__construct();	}		public function before(){		//$this->needLogin = true; // раскоментируйте, чтобы закрыть доступ ко всем страницам данного контроллера		parent::before();	}	public function action_index(){		$this->action_all();	}		public function action_all(){		$this->title .= 'Новости';			$art_num = isset($this->params[2]) ? (int)$this->params[2] : 1;				$mPagination = new Pagination('articles', '/news/all/');		$lang = I18n::language();		$news = $mPagination->on_page(4)->page_num($art_num)->left_join('images using(id_image)')							->left_join('i18n using(id_article)')->where("i18n.is_show = '1' AND id_lang = '$lang'")->page();							        foreach($news as $key=>$new){            $news[$key]['intro'] = M_Articles::Instance()->intro($new['content'], 250, true);        }        		$navbar = $this->Template('v_navbar.php', array('navparams' => $mPagination->navparams()));		$this->content = $this->Template('v_news.php', array('news' => $news,																	   'navparams' => $mPagination->navparams(),																	   'navbar' => $navbar));	}	    public function action_post(){        $this->title .= 'Новость';                              $id_article = (int)$this->params[2];        $article = M_Articles::Instance()->get($id_article, true);                if(empty($article))            $this->p404();                $this->content = $this->Template('articles/v_post.php',  array('article' => $article,                                                                         'news' => $this->request('widget/latest_news/'.$id_article)));    }}